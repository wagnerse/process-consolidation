<?xml version="1.0" encoding="UTF-8"?>
<process
    abstractProcessProfile="urn:HPI_IAAS:choreography:profile:2006/12"
    exitOnStandardFault="yes" name="ProcessMerged"
    suppressJoinFailure="yes"
    targetNamespace="http://uni-stuttgart.de/iaas/bpel/ScenarioWithoutComActivity"
    xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/abstract"
    xmlns:ns="http://uni-stuttgart.de/iaas/bpel/ScenarioWithoutComActivity"
    xmlns:ns0="http://www.w3.org/2001/XMLSchema" xmlns:ns1="http://uni-stuttgart.de/iaas/bpel/ScenarioWithIncomingLink">
    <import importType="http://schemas.xmlsoap.org/wsdl/"
        location="ScenarioWithoutComActivityArtifacts.wsdl" namespace="http://uni-stuttgart.de/iaas/bpel/ScenarioWithoutComActivity"/>
    <import importType="http://schemas.xmlsoap.org/wsdl/"
        location="ScenarioWithIncomingLinkArtifacts.wsdl" namespace="http://uni-stuttgart.de/iaas/bpel/ScenarioWithIncomingLink"/>
    <variables>
        <variable
            messageType="ns:ScenarioWithoutComActivityRequestMessage" name="input"/>
        <variable
            messageType="ns:ScenarioWithoutComActivityResponseMessage" name="clientSWCAResponse"/>
    </variables>
    <flow name="MergedFlow">
        <links>
            <link name="CallSupportProcessTOAssign"/>
            <link name="replyRequestSWCATOEmptyWvcR"/>
        </links>
        <scope exitOnStandardFault="yes"
            name="Scope_ScenarioWithoutComActivity" suppressJoinFailure="yes">
            <variables>
                <variable
                    messageType="ns:ScenarioWithoutComActivityResponseMessage" name="output"/>
                <variable name="errorMessage" type="ns0:string"/>
            </variables>
            <partnerLinks>
                <partnerLink initializePartnerRole="no"
                    myRole="ScenarioWithoutComActivityProvider"
                    name="client" partnerLinkType="ns:ScenarioWithoutComActivity"/>
            </partnerLinks>
            <faultHandlers>
                <catch>
                    <sequence>
                        <assign name="Error" validate="no">
                            <copy>
                                <from>
                                    <literal>Es ist ein Fehler aufgetreten.</literal>
                                </from>
                                <to variable="errorMessage"/>
                            </copy>
                        </assign>
                    </sequence>
                </catch>
                <catchAll>
                    <compensate/>
                </catchAll>
            </faultHandlers>
            <sequence name="main">
                <assign name="Assign" validate="no">
                    <targets>
                        <target linkName="CallSupportProcessTOAssign"/>
                    </targets>
                    <copy>
                        <from>
                            <literal>
                                <tns:ScenarioWithoutComActivityResponse
                                    xmlns:tns="http://uni-stuttgart.de/iaas/bpel/ScenarioWithoutComActivity" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                                    <tns:result>tns:result</tns:result>
                                </tns:ScenarioWithoutComActivityResponse>
                            </literal>
                        </from>
                        <to part="payload" variable="output"/>
                    </copy>
                    <copy>
                        <from part="payload" variable="input">
                            <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:input]]></query>
                        </from>
                        <to part="payload" variable="output">
                            <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:result]]></query>
                        </to>
                    </copy>
                </assign>
                <if name="If">
                    <condition><![CDATA[$input.payload/tns:input="Hallo"]]></condition>
                    <sequence>
                        <assign name="Fehler_ausgabe" validate="no">
                            <copy>
                                <from>
                                    <literal>Es wird ein Fehler geworfen</literal>
                                </from>
                                <to part="payload" variable="output">
                                    <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:result]]></query>
                                </to>
                            </copy>
                        </assign>
                        <assign name="replyRequestSWCA" validate="no">
                            <sources>
                                <source linkName="replyRequestSWCATOEmptyWvcR"/>
                            </sources>
                            <copy>
                                <from variable="output"/>
                                <to variable="clientSWCAResponse"/>
                            </copy>
                        </assign>
                        <throw name="Falsche_Eingabe"/>
                    </sequence>
                    <else>
                        <sequence name="Sequence">
                            <reply name="replyRequestSWCA" variable="output"/>
                        </sequence>
                    </else>
                </if>
            </sequence>
        </scope>
        <scope name="FH_SurScope_Scope_ScenarioWithIncomingLink">
            <variables>
                <variable
                    messageType="ns1:ScenarioWithIncomingLinkRequestMessage" name="input"/>
                <variable
                    messageType="ns1:ScenarioWithIncomingLinkResponseMessage" name="output"/>
                <variable
                    messageType="ns:ScenarioWithoutComActivityRequestMessage" name="clientSWCARequest"/>
            </variables>
            <faultHandlers>
                <catchAll>
                    <compensate/>
                </catchAll>
            </faultHandlers>
            <flow name="FH_Processing_Scope_ScenarioWithIncomingLink">
                <links>
                    <link name="8da96200-a247-429f-bd33-e1a66dd1f575"/>
                    <link name="f2d6324c-ef9a-46b9-b49f-5d99783a698d"/>
                    <link name="1304df90-e2a1-4c31-add3-e293fe1808b0"/>
                </links>
                <empty name="continueProcess">
                    <targets>
                        <target linkName="f2d6324c-ef9a-46b9-b49f-5d99783a698d"/>
                        <target linkName="1304df90-e2a1-4c31-add3-e293fe1808b0"/>
                    </targets>
                </empty>
                <scope name="Scope_ScenarioWithIncomingLink_catch">
                    <targets>
                        <target linkName="8da96200-a247-429f-bd33-e1a66dd1f575"/>
                    </targets>
                    <sources>
                        <source linkName="f2d6324c-ef9a-46b9-b49f-5d99783a698d"/>
                    </sources>
                    <compensationHandler>
                        <empty/>
                    </compensationHandler>
                    <sequence>
                        <assign name="ErrorAssign" validate="no">
                            <copy>
                                <from>
                                    <literal>

                                    <tns:ScenarioWithoutComActivityRequest
                                    xmlns:tns="http://uni-stuttgart.de/iaas/bpel/ScenarioWithoutComActivity" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                                    <tns:input>Fehler vom Faulthandler</tns:input>
                                    </tns:ScenarioWithoutComActivityRequest>
                                    </literal>
                                </from>
                                <to part="payload" variable="clientSWCARequest"/>
                            </copy>
                        </assign>
                        <sequence>
                            <assign name="CallSupportProcess" validate="no">
                                <sources>
                                    <source linkName="CallSupportProcessTOAssign"/>
                                </sources>
                                <copy>
                                    <from variable="clientSWCARequest"/>
                                    <to variable="input"/>
                                </copy>
                            </assign>
                            <empty>
                                <targets>
                                    <target linkName="replyRequestSWCATOEmptyWvcR"/>
                                </targets>
                            </empty>
                        </sequence>
                    </sequence>
                </scope>
                <scope exitOnStandardFault="yes"
                    name="Scope_ScenarioWithIncomingLink" suppressJoinFailure="yes">
                    <sources>
                        <source linkName="1304df90-e2a1-4c31-add3-e293fe1808b0"/>
                    </sources>
                    <partnerLinks>
                        <partnerLink initializePartnerRole="no"
                            myRole="ScenarioWithIncomingLinkProvider"
                            name="client" partnerLinkType="ns1:ScenarioWithIncomingLink"/>
                    </partnerLinks>
                    <faultHandlers>
                        <catch>
                            <empty>
                                <sources>
                                    <source linkName="8da96200-a247-429f-bd33-e1a66dd1f575"/>
                                </sources>
                            </empty>
                        </catch>
                        <catchAll>
                            <compensate/>
                        </catchAll>
                    </faultHandlers>
                    <sequence name="main">
                        <receive createInstance="yes"
                            name="receiveInput" variable="input"/>
                        <assign name="Assign" validate="no">
                            <copy>
                                <from>
                                    <literal>

                                    <tns:ScenarioWithIncomingLinkResponse
                                    xmlns:tns="http://uni-stuttgart.de/iaas/bpel/ScenarioWithIncomingLink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                                    <tns:result>tns:result</tns:result>
                                    </tns:ScenarioWithIncomingLinkResponse>
                                    </literal>
                                </from>
                                <to part="payload" variable="output"/>
                            </copy>
                            <copy>
                                <from part="payload" variable="input">
                                    <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:input]]></query>
                                </from>
                                <to part="payload" variable="output">
                                    <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:result]]></query>
                                </to>
                            </copy>
                        </assign>
                        <if name="If">
                            <condition><![CDATA[$input.payload/tns:input="Hallo"]]></condition>
                            <sequence>
                                <assign name="Fehler_ausgabe" validate="no">
                                    <copy>
                                    <from>
                                    <literal>Es wird ein Fehler geworfen</literal>
                                    </from>
                                    <to part="payload" variable="output">
                                    <query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:result]]></query>
                                    </to>
                                    </copy>
                                </assign>
                                <reply name="replyOutput" variable="output"/>
                                <throw name="Falsche_Eingabe"/>
                            </sequence>
                            <else>
                                <sequence name="Sequence">
                                    <reply
                                    name="ReplyOutput_ohne_Fehler" variable="output"/>
                                </sequence>
                            </else>
                        </if>
                    </sequence>
                </scope>
            </flow>
        </scope>
    </flow>
</process>
