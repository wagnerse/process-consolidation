<?xml version="1.0" encoding="UTF-8"?>
<process
    abstractProcessProfile="urn:HPI_IAAS:choreography:profile:2006/12"
    exitOnStandardFault="yes" name="ProcessMerged"
    suppressJoinFailure="yes"
    targetNamespace="http://www.iaas.uni-stuttgart.de"
    xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/abstract"
    xmlns:ns="http://www.w3.org/2001/XMLSchema" xmlns:ns0="http://www.iaas.uni-stuttgart.de">
    <import importType="http://schemas.xmlsoap.org/wsdl/"
        location="P2ASP23.wsdl" namespace="http://www.iaas.uni-stuttgart.de"/>
    <import importType="http://schemas.xmlsoap.org/wsdl/"
        location="P1ASP23.wsdl" namespace="http://www.iaas.uni-stuttgart.de"/>
    <import importType="http://schemas.xmlsoap.org/wsdl/"
        location="P3ASP23.wsdl" namespace="http://www.iaas.uni-stuttgart.de"/>
    <variables>
        <variable name="PickABce_activated" type="ns:boolean">
            <from><![CDATA[false()]]></from>
        </variable>
        <variable messageType="ns0:P12P2ASP23RequestMessage" name="varRec1P2"/>
    </variables>
    <flow name="MergedFlow">
        <links>
            <link name="Invoke1P3ASP23TOPick"/>
            <link name="Invoke1P1ASP23TOPick"/>
        </links>
        <scope exitOnStandardFault="yes" name="Scope_P3ASP23" suppressJoinFailure="yes">
            <variables>
                <variable messageType="ns0:P3ASP23RequestMessage" name="input"/>
                <variable messageType="ns0:P3ASP23ResponseMessage" name="output"/>
                <variable name="varInv1"/>
            </variables>
            <partnerLinks>
                <partnerLink initializePartnerRole="no"
                    myRole="P3ASP23Provider" name="client"
                    partnerLinkType="ns0:P3ASP23" partnerRole="P3ASP23Requester"/>
            </partnerLinks>
            <faultHandlers>
                <catchAll>
                    <compensate/>
                </catchAll>
            </faultHandlers>
            <flow name="main">
                <links>
                    <link name="link1"/>
                    <link name="link2"/>
                    <link name="link4"/>
                    <link name="link3"/>
                </links>
                <receive createInstance="yes" name="receiveInputP3ASP23" variable="input">
                    <sources>
                        <source linkName="link1"/>
                    </sources>
                </receive>
                <invoke inputVariable="output" name="callbackClientP3ASP23">
                    <targets>
                        <target linkName="link4"/>
                    </targets>
                </invoke>
                <empty name="Empty1">
                    <targets>
                        <target linkName="link1"/>
                    </targets>
                    <sources>
                        <source linkName="link2"/>
                    </sources>
                </empty>
                <empty name="Empty2">
                    <targets>
                        <target linkName="link3"/>
                    </targets>
                    <sources>
                        <source linkName="link4"/>
                    </sources>
                </empty>
                <if name="Invoke1P3ASP23">
                    <targets>
                        <target linkName="link2"/>
                    </targets>
                    <sources>
                        <source linkName="link3"/>
                    </sources>
                    <condition><![CDATA[PickABce_activated!=true()]]></condition>
                    <assign validate="no">
                        <sources>
                            <source linkName="Invoke1P3ASP23TOPick"/>
                        </sources>
                        <copy>
                            <from><![CDATA[true()]]></from>
                            <to variable="PickABce_activated"/>
                        </copy>
                        <copy>
                            <from variable="varInv1"/>
                            <to variable="varRec1P2"/>
                        </copy>
                    </assign>
                </if>
            </flow>
        </scope>
        <scope exitOnStandardFault="yes" name="Scope_P2ASP23" suppressJoinFailure="yes">
            <variables>
                <variable messageType="ns0:P2ASP23RequestMessage" name="input"/>
                <variable messageType="ns0:P2ASP23ResponseMessage" name="output"/>
                <variable messageType="ns0:P12P2ASP23RequestMessage" name="varRec2P2"/>
                <variable messageType="ns0:P12P2ASP23RequestMessage" name="varRec3P2"/>
            </variables>
            <partnerLinks>
                <partnerLink initializePartnerRole="no"
                    myRole="P2ASP23Provider" name="client"
                    partnerLinkType="ns0:P2ASP23" partnerRole="P2ASP23Requester"/>
            </partnerLinks>
            <faultHandlers>
                <catchAll>
                    <compensate/>
                </catchAll>
            </faultHandlers>
            <flow name="main">
                <links>
                    <link name="link1"/>
                    <link name="link4"/>
                    <link name="link2"/>
                    <link name="link5"/>
                    <link name="link3"/>
                </links>
                <receive createInstance="yes" name="receiveInputP2ASP23" variable="input">
                    <sources>
                        <source linkName="link1"/>
                    </sources>
                </receive>
                <invoke inputVariable="output" name="callbackClientP2ASP23">
                    <targets>
                        <target linkName="link4"/>
                    </targets>
                </invoke>
                <empty name="Empty1">
                    <targets>
                        <target linkName="link1"/>
                    </targets>
                    <sources>
                        <source linkName="link2"/>
                    </sources>
                </empty>
                <empty name="Empty2">
                    <targets>
                        <target linkName="link3"/>
                    </targets>
                    <sources>
                        <source linkName="link4"/>
                    </sources>
                </empty>
                <empty name="Empty3">
                    <sources>
                        <source linkName="link5"/>
                    </sources>
                </empty>
                <scope name="Pick">
                    <targets>
                        <target linkName="link2"/>
                        <target linkName="link5"/>
                    </targets>
                    <sources>
                        <source linkName="link3"/>
                    </sources>
                    <faultHandlers>
                        <catch faultName="ns0:Pick1P2ASP23Fault">
                            <empty name="EmptyPick1"/>
                        </catch>
                        <catch faultName="ns0:Pick2P2ASP23Fault">
                            <empty name="EmptyPick2"/>
                        </catch>
                        <catch faultName="ns0:Pick3P2ASP23Fault">
                            <empty name="EmptyPick3"/>
                        </catch>
                        <catch faultName="ns0:wait0Fault">
                            <scope exitOnStandardFault="no" isolated="no">
                                <empty name="EmptyPick4"/>
                            </scope>
                        </catch>
                        <catch faultName="ns0:wait1Fault">
                            <scope exitOnStandardFault="no" isolated="no">
                                <empty name="EmptyPick5"/>
                            </scope>
                        </catch>
                    </faultHandlers>
                    <flow>
                        <sequence>
                            <receive createInstance="no"
                                name="Pick2P2ASP23" variable="varRec2P2"/>
                            <assign validate="no">
                                <copy>
                                    <from><![CDATA[true()]]></from>
                                    <to variable="PickABce_activated"/>
                                </copy>
                            </assign>
                            <throw faultName="ns0:Pick2P2ASP23Fault"/>
                        </sequence>
                        <sequence>
                            <receive createInstance="no"
                                name="Pick3P2ASP23" variable="varRec3P2"/>
                            <assign validate="no">
                                <copy>
                                    <from><![CDATA[true()]]></from>
                                    <to variable="PickABce_activated"/>
                                </copy>
                            </assign>
                            <throw faultName="ns0:Pick3P2ASP23Fault"/>
                        </sequence>
                        <sequence>
                            <wait>
                                <for><![CDATA['P3DT10H']]></for>
                            </wait>
                            <assign validate="no">
                                <copy>
                                    <from><![CDATA[true()]]></from>
                                    <to variable="PickABce_activated"/>
                                </copy>
                            </assign>
                            <throw faultName="ns0:wait0Fault"/>
                        </sequence>
                        <sequence>
                            <wait>
                                <until><![CDATA['2008-10-28T10:28:19']]></until>
                            </wait>
                            <assign validate="no">
                                <copy>
                                    <from><![CDATA[true()]]></from>
                                    <to variable="PickABce_activated"/>
                                </copy>
                            </assign>
                            <throw faultName="ns0:wait1Fault"/>
                        </sequence>
                        <throw faultName="ns0:Pick1P2ASP23Fault">
                            <targets>
                                <target linkName="Invoke1P3ASP23TOPick"/>
                            </targets>
                        </throw>
                        <throw faultName="ns0:Pick1P2ASP23Fault">
                            <targets>
                                <target linkName="Invoke1P1ASP23TOPick"/>
                            </targets>
                        </throw>
                    </flow>
                </scope>
            </flow>
        </scope>
        <scope exitOnStandardFault="yes" name="Scope_P1ASP23" suppressJoinFailure="yes">
            <variables>
                <variable messageType="ns0:P1ASP23RequestMessage" name="input"/>
                <variable messageType="ns0:P1ASP23ResponseMessage" name="output"/>
                <variable messageType="ns0:P12P2ASP23RequestMessage" name="varInv1"/>
            </variables>
            <partnerLinks>
                <partnerLink initializePartnerRole="no"
                    myRole="P1ASP23Provider" name="client"
                    partnerLinkType="ns0:P1ASP23" partnerRole="P1ASP23Requester"/>
            </partnerLinks>
            <faultHandlers>
                <catchAll>
                    <compensate/>
                </catchAll>
            </faultHandlers>
            <flow name="main">
                <links>
                    <link name="link1"/>
                    <link name="link2"/>
                    <link name="link4"/>
                    <link name="link3"/>
                    <link name="link5"/>
                    <link name="link7"/>
                    <link name="link8"/>
                </links>
                <receive createInstance="yes" name="receiveInputP1ASP23" variable="input">
                    <sources>
                        <source linkName="link1"/>
                    </sources>
                </receive>
                <invoke inputVariable="output" name="callbackClientP1ASP23">
                    <targets>
                        <target linkName="link4"/>
                    </targets>
                </invoke>
                <empty name="Empty1">
                    <targets>
                        <target linkName="link1"/>
                    </targets>
                    <sources>
                        <source linkName="link2"/>
                    </sources>
                </empty>
                <empty name="Empty2">
                    <targets>
                        <target linkName="link5"/>
                    </targets>
                    <sources>
                        <source linkName="link4"/>
                    </sources>
                </empty>
                <if name="Invoke1P1ASP23">
                    <targets>
                        <target linkName="link2"/>
                        <target linkName="link7"/>
                        <target linkName="link8"/>
                    </targets>
                    <sources>
                        <source linkName="link3"/>
                    </sources>
                    <condition><![CDATA[PickABce_activated!=true()]]></condition>
                    <assign validate="no">
                        <sources>
                            <source linkName="Invoke1P1ASP23TOPick"/>
                        </sources>
                        <copy>
                            <from><![CDATA[true()]]></from>
                            <to variable="PickABce_activated"/>
                        </copy>
                        <copy>
                            <from variable="varInv1"/>
                            <to variable="varRec1P2"/>
                        </copy>
                    </assign>
                </if>
                <scope exitOnStandardFault="no" isolated="no" name="Scope">
                    <targets>
                        <target linkName="link3"/>
                    </targets>
                    <sources>
                        <source linkName="link5"/>
                    </sources>
                    <flow name="Flow">
                        <links>
                            <link name="link6"/>
                        </links>
                        <empty name="Empty3">
                            <sources>
                                <source linkName="link6"/>
                            </sources>
                        </empty>
                        <scope exitOnStandardFault="no" isolated="no" name="Scope1">
                            <targets>
                                <target linkName="link6"/>
                            </targets>
                            <empty name="Empty4"/>
                        </scope>
                    </flow>
                </scope>
                <empty name="Empty5">
                    <sources>
                        <source linkName="link7"/>
                    </sources>
                </empty>
                <empty name="Empty6">
                    <sources>
                        <source linkName="link8"/>
                    </sources>
                </empty>
            </flow>
        </scope>
    </flow>
</process>
